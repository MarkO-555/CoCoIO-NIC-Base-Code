
5 DIM IN$(256) : OUT$(256) : REM BUFFERS
6 X=0 : Y=0 : Z=0 : A$="" : B$="" : C$=""
7 S1=0 : S2=0 : S3=0 : S4=0 : P1=0 : P2=0 : P3=0 : P4=0 : 

10 CLS
20 PRINT "  TWIZNET 5100 v.01  " : PRINT
110 POKE &HFF68,&H80   'RESET 5100
120 POKE &HFF68,&H13   'AUTO:INC, INDRECT MODE, PING RESPOND 
130 REM
900 'POKE &HFF69,&H00 : POKE &HFF6A,&H01   'START OF CONFIG
995 REM
1000 ' ** GATEWAY **
1010 POKE &HFF69,&H00 : POKE &HFF6A,&H01
1020 POKE &HFF6B,192 : POKE &HFF6B,168 : POKE &HFF6B,253 : POKE &HFF6B,254
1030 REM

1100 POKE &HFF69,0 : POKE &HFF6A,01
1200 PRINT " GATEWAY"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)

2000 ' ** SUBNET **
2010 POKE &HFF69,&H00 : POKE &HFF6A,&H05
2020 POKE &HFF6B,255 : POKE &HFF6B,255 : POKE &HFF6B,255 : POKE &HFF6B,0
2030 REM
2040 POKE &HFF69,&H00 : POKE &HFF6A,&H05
2050 PRINT "  SUBNET"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)

2090 REM
3000 ' ** MAC ADDR **
3010 POKE &HFF69,&H00 : POKE &HFF6A,&H09
3020 POKE &HFF6B,&HAA : POKE &HFF6B,&H55 : POKE &HFF6B,&HAA : POKE &HFF6B,&H55 : POKE &HFF6B,&HAA : POKE &HFF6B,&H55
3030 REM
3050 POKE &HFF69,&H00 : POKE &HFF6A,&H09
3060 PRINT "MAC ADDR"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)

3090 REM
4000 ' ** MY IP **
4010 POKE &HFF69,&H00 : POKE &HFF6A,&H0F
4020 POKE &HFF6B,192 : POKE &HFF6B,168 : POKE &HFF6B,253 : POKE &HFF6B,10
4030 REM
4070 POKE &HFF69,&H00 : POKE &HFF6A,&H0F
4080 PRINT "   MY IP"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)
4090 REM

5000 PRINT "SETUP FOREIGN CONNECTION"
5100 ' ** TCP MODE **
5110 POKE &HFF69,&H04 : POKE &HFF6A,&H00
5120 POKE &HFF6B,&H01 
5150 ' ** LOCAL PORT **
5160 POKE &HFF69,&H04 : POKE &HFF6A,&H04
5170 POKE &HFF6B,&HC0 : POKE &HFF6B,&H00 : ' ** &HC000 (49152) ** 
5200 ' ** FOREIGN ADDRESS **
5210 POKE &HFF69,&H04 : POKE &HFF6A,&H0C
5220 POKE &HFF6B,&HC0 :  POKE &HFF6B,&HA8 : POKE &HFF6B,&HFD : POKE &HFF6B,&H64 : 192.168.253.100
5250 ' ** FOREIGN PORT **
5260 'POKE &HFF69,&H04 : POKE &HFF6A,&H04
5270 POKE &HFF6B,&H1B : POKE &HFF6B,&H62 : ' ** &H1B62 (7010) ** 

5300 ' ** TCP OPEN SOCKET **
5310 POKE &HFF69,&H04 : POKE &HFF6A,&H01
5320 POKE &HFF6B,&H01
  
5350 ' ** CHECK STATUS **
5360 POKE &HFF69,&H04 : POKE &HFF6A,&H03
5370 S1=PEEK (&HFF6B) : IF S1<>&H13 THEN 60000 : ' ** &H13 IS OPEN **
5380  
5400 ' ** FOREIGN ADDRESS **
5410 POKE &HFF69,&H04 : POKE &HFF6A,&H0C
5420 POKE &HFF6B,&HC0 :  POKE &HFF6B,&HA8 : POKE &HFF6B,&HFD : POKE &HFF6B,&H64 : 192.168.253.100
5450 ' ** FOREIGN PORT **
5460 'POKE &HFF69,&H04 : POKE &HFF6A,&H04
5470 POKE &HFF6B,&H1B : POKE &HFF6B,&H62 : ' ** &H1B62 (7010) ** 


 
10000 PRINT : PRINT : PRINT "** RESULTS (CHECK) **"
10010 POKE &HFF69,0 : POKE &HFF6A,01
10020 PRINT " GATEWAY"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)
10030 POKE &HFF69,&H00 : POKE &HFF6A,&H05
10040 PRINT "  SUBNET"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)
10050 POKE &HFF69,&H00 : POKE &HFF6A,&H09
10060 PRINT "MAC ADDR"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)
10070 POKE &HFF69,&H00 : POKE &HFF6A,&H0F
10080 PRINT "   MY IP"; PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B); PEEK(&HFF6B)
20000 REM
59000 END
60000 PRINT : PRINT "FOREIGN HOST OPEN FAIL..." : END
60010 PRINT : PRINT "FOREIGN HOST OPEN FAIL..." : END
60020 PRINT : PRINT "FOREIGN HOST OPEN FAIL..." : END

